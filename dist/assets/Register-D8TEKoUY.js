import{d as S,u as V,c as R,w as T,a as d,f as s,q as B,g as u,l as w,r as p,t as g,m,v as f,z as E,y as b,n as v,j as y,b as I}from"./index-B98qeLDM.js";import{u as U,M as z,s as A,r as F}from"./MainLayout-DXgy6rrV.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"register-page"},D={class:"register-container"},Z={class:"register-form"},j={key:0,class:"error-message"},q={class:"form-row"},L={class:"form-control"},$=["placeholder"],G={class:"form-row"},H={class:"form-control with-btn"},J=["disabled"],K={class:"form-row"},O={class:"form-control"},Q=["placeholder"],W={key:1,class:"form-row"},X={class:"form-control"},Y={class:"password-strength"},ss={class:"strength-bars"},es={class:"strength-text"},os={class:"form-row"},ts={class:"form-control"},rs=["placeholder"],ls={class:"form-row"},as={class:"form-control"},ns=["disabled"],is={key:0,class:"loading-spinner"},ds={key:1},cs=S({__name:"Register",setup(us){const{t:l}=V(),x=I(),h=U(),c=p(!1),_=p(!1),n=p(0),r=p(""),o=E({mobile:"",verify_code:"",password:"",confirm_password:""}),i=y(()=>{const t=o.password;if(!t)return 0;let e=0;return t.length>=6&&e++,t.length>=8&&e++,/[A-Z]/.test(t)&&e++,/[0-9]/.test(t)&&e++,/[^A-Za-z0-9]/.test(t)&&e++,Math.min(e,4)}),k=y(()=>["","弱","中","强","很强"][i.value]),C=async()=>{if(!o.mobile||o.mobile.length!==11){r.value=l("login.mobileError");return}_.value=!0;try{const t=await A(o.mobile);if(t.code===200){n.value=60;const e=setInterval(()=>{n.value--,n.value<=0&&clearInterval(e)},1e3)}else r.value=t.message||"Failed to send code"}catch(t){console.error("Send code error:",t)}finally{_.value=!1}},M=async()=>{if(r.value="",!o.mobile||o.mobile.length!==11){r.value=l("login.mobileError");return}if(!o.verify_code){r.value=l("register.verifyCode");return}if(!o.password||o.password.length<6){r.value=l("login.passwordError");return}if(o.password!==o.confirm_password){r.value=l("register.confirmPassword");return}c.value=!0;try{const t=await F({mobile:o.mobile,verify_code:o.verify_code,password:o.password,confirm_password:o.confirm_password});t.code===200&&t.data?(h.setToken(t.data.access_token,t.data.token_type,t.data.expires_at),await h.fetchCurrentCustomer(),x.push("/")):r.value=t.message||l("register.registerFailed")}catch(t){console.error("Register error:",t),r.value=l("register.registerFailed")}finally{c.value=!1}};return(t,e)=>(d(),R(z,null,{default:T(()=>[s("div",P,[s("div",D,[e[11]||(e[11]=s("h1",{class:"page-title"},[s("span",{class:"highlight"},"免费注册"),B("鼎丰28-幸运28领头羊,打造28行业信誉平台. ")],-1)),s("div",Z,[r.value?(d(),u("div",j,g(r.value),1)):w("",!0),s("div",q,[e[4]||(e[4]=s("label",{class:"form-label"},"手机号码",-1)),s("div",L,[m(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>o.mobile=a),type:"text",placeholder:b(l)("login.inputMobile"),maxlength:"11"},null,8,$),[[f,o.mobile]])])]),s("div",G,[e[5]||(e[5]=s("label",{class:"form-label"},null,-1)),s("div",H,[m(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o.verify_code=a),type:"text",placeholder:"验证码",maxlength:"6"},null,512),[[f,o.verify_code]]),s("button",{type:"button",class:"btn-code",disabled:n.value>0||_.value,onClick:C},g(n.value>0?`${n.value}s`:"获取验证码"),9,J)])]),s("div",K,[e[6]||(e[6]=s("label",{class:"form-label"},"登录密码",-1)),s("div",O,[m(s("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>o.password=a),type:"password",placeholder:b(l)("login.inputPassword")},null,8,Q),[[f,o.password]])])]),o.password?(d(),u("div",W,[e[8]||(e[8]=s("label",{class:"form-label"},null,-1)),s("div",X,[s("div",Y,[e[7]||(e[7]=s("span",{class:"strength-label"},"密码强度",-1)),s("div",ss,[s("span",{class:v(["bar",{active:i.value>=1}])},null,2),s("span",{class:v(["bar",{active:i.value>=2}])},null,2),s("span",{class:v(["bar",{active:i.value>=3}])},null,2),s("span",{class:v(["bar",{active:i.value>=4}])},null,2)]),s("span",es,g(k.value),1)])])])):w("",!0),s("div",os,[e[9]||(e[9]=s("label",{class:"form-label"},"确认密码",-1)),s("div",ts,[m(s("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>o.confirm_password=a),type:"password",placeholder:b(l)("register.confirmPassword")},null,8,rs),[[f,o.confirm_password]])])]),s("div",ls,[e[10]||(e[10]=s("label",{class:"form-label"},null,-1)),s("div",as,[s("button",{type:"button",class:"btn-submit",disabled:c.value,onClick:M},[c.value?(d(),u("span",is)):(d(),u("span",ds,"注册"))],8,ns)])])])])])]),_:1}))}}),vs=N(cs,[["__scopeId","data-v-e21eab9d"]]);export{vs as default};
