import{d as C,o as N,y as V,w as z,f as e,c as n,r,k as B,j as y,A as L,F as b,g as _,v as U,t as a,e as D,p as o,n as E,s as M}from"./index-AM8iu888.js";import{U as T}from"./UserLayout-PXQSL144.js";import{h as F}from"./MainLayout-MF4nldfZ.js";import{f as P}from"./customer-DaK2EvEO.js";const Q=f=>F.post("/api/app/v1/card/records",f),R={class:"exchange-page"},j={key:0,class:"security-verify"},A={class:"verify-form"},I={class:"form-row"},G=["value"],H={class:"form-row"},J={class:"form-row"},K=["disabled"],O={key:1,class:"exchange-content"},W={key:0,class:"loading-state"},X={key:1,class:"exchange-table"},Y={class:"coin"},Z={class:"time"},$={key:0},q=C({__name:"Exchange",setup(f){const p=r(!1),d=r("1"),i=r(""),u=r(!1),g=[{value:"1",label:"我父亲的姓名是什么?"},{value:"2",label:"我母亲的姓名是什么?"},{value:"3",label:"我的出生地是哪里?"},{value:"4",label:"我的小学名称是什么?"},{value:"5",label:"我最喜欢的颜色是什么?"}],c=r([]),v=r(!1),h=r(1),k=r(20),x=async()=>{if(!i.value.trim()){alert("请输入答案");return}u.value=!0;try{const l=await P({safe_ask:d.value,answer:i.value});l.code===200?(p.value=!0,w()):alert(l.message||"验证失败")}catch{alert("验证失败")}finally{u.value=!1}},w=async()=>{v.value=!0;try{const l=await Q({pagination:{page:h.value,size:k.value}});l.code===200&&l.data&&(c.value=l.data)}catch(l){console.error("加载兑奖记录失败",l)}finally{v.value=!1}},S=l=>l?new Date(l*1e3).toLocaleString("zh-CN"):"-",m=l=>l===void 0?"0":l.toLocaleString();return N(()=>{}),(l,t)=>(o(),V(T,null,{default:z(()=>[e("div",R,[t[8]||(t[8]=e("div",{class:"page-tabs"},[e("span",{class:"tab active"},"兑奖记录")],-1)),p.value?(o(),n("div",O,[v.value?(o(),n("div",W,"加载中...")):(o(),n("div",X,[e("table",null,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"卡号"),e("th",null,"卡密"),e("th",null,"类型"),e("th",null,"金豆"),e("th",null,"手续费"),e("th",null,"状态"),e("th",null,"兑换时间")])],-1)),e("tbody",null,[(o(!0),n(b,null,_(c.value,s=>(o(),n("tr",{key:s.id},[e("td",null,a(s.no||"-"),1),e("td",null,a(s.pwd||"-"),1),e("td",null,a(s.type_label||"-"),1),e("td",Y,a(m(s.points)),1),e("td",null,a(m(s.sxf)),1),e("td",{class:E(["status",s.state===1?"done":""])},a(s.state_label||"-"),3),e("td",Z,a(S(s.addtime)),1)]))),128)),c.value.length===0?(o(),n("tr",$,[...t[6]||(t[6]=[e("td",{colspan:"7",class:"empty-cell"},"暂无兑奖记录",-1)])])):D("",!0)])])]))])):(o(),n("div",j,[t[5]||(t[5]=e("div",{class:"verify-notice"},[e("span",{class:"notice-icon"},"!"),B(" 你需要通过密保验证后才能查看这个页面! ")],-1)),e("div",A,[e("div",I,[t[2]||(t[2]=e("label",{class:"form-label"},"安全问题",-1)),y(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),class:"form-select"},[(o(),n(b,null,_(g,s=>e("option",{key:s.value,value:s.value},a(s.label),9,G)),64))],512),[[L,d.value]])]),e("div",H,[t[3]||(t[3]=e("label",{class:"form-label"},"答案",-1)),y(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s),class:"form-input",placeholder:"请输入答案"},null,512),[[U,i.value]])]),e("div",J,[t[4]||(t[4]=e("label",{class:"form-label"},null,-1)),e("button",{class:"btn-submit",onClick:x,disabled:u.value},a(u.value?"验证中...":"提交"),9,K)])])]))])]),_:1}))}}),ae=M(q,[["__scopeId","data-v-66caf672"]]);export{ae as default};
