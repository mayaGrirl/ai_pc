import{d as C,o as z,x as N,w as V,g as a,f as e,c as n,r,q as B,p as y,z as L,F as _,j as b,t as o,v as U,e as D,n as E}from"./index-CpMdb0R9.js";import{U as M}from"./UserLayout-DCaq-oJe.js";import{h as T}from"./MainLayout-rB-7dyln.js";import{f as F}from"./customer-BjLKFxoe.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=f=>T.post("/api/app/v1/card/records",f),R={class:"exchange-page"},j={key:0,class:"security-verify"},I={class:"verify-form"},A={class:"form-row"},G=["value"],H={class:"form-row"},J={class:"form-row"},K=["disabled"],O={key:1,class:"exchange-content"},W={key:0,class:"loading-state"},X={key:1,class:"exchange-table"},Y={class:"coin"},Z={class:"time"},$={key:0},q=C({__name:"Exchange",setup(f){const p=r(!1),d=r("1"),i=r(""),u=r(!1),g=[{value:"1",label:"我父亲的姓名是什么?"},{value:"2",label:"我母亲的姓名是什么?"},{value:"3",label:"我的出生地是哪里?"},{value:"4",label:"我的小学名称是什么?"},{value:"5",label:"我最喜欢的颜色是什么?"}],c=r([]),v=r(!1),h=r(1),x=r(20),k=async()=>{if(!i.value.trim()){alert("请输入答案");return}u.value=!0;try{const l=await F({safe_ask:d.value,answer:i.value});l.code===200?(p.value=!0,w()):alert(l.message||"验证失败")}catch{alert("验证失败")}finally{u.value=!1}},w=async()=>{v.value=!0;try{const l=await Q({pagination:{page:h.value,size:x.value}});l.code===200&&l.data&&(c.value=l.data)}catch(l){console.error("加载兑奖记录失败",l)}finally{v.value=!1}},S=l=>l?new Date(l*1e3).toLocaleString("zh-CN"):"-",m=l=>l===void 0?"0":l.toLocaleString();return z(()=>{}),(l,t)=>(a(),N(M,null,{default:V(()=>[e("div",R,[t[8]||(t[8]=e("div",{class:"page-tabs"},[e("span",{class:"tab active"},"兑奖记录")],-1)),p.value?(a(),n("div",O,[v.value?(a(),n("div",W,"加载中...")):(a(),n("div",X,[e("table",null,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"卡号"),e("th",null,"卡密"),e("th",null,"类型"),e("th",null,"金豆"),e("th",null,"手续费"),e("th",null,"状态"),e("th",null,"兑换时间")])],-1)),e("tbody",null,[(a(!0),n(_,null,b(c.value,s=>(a(),n("tr",{key:s.id},[e("td",null,o(s.no||"-"),1),e("td",null,o(s.pwd||"-"),1),e("td",null,o(s.type_label||"-"),1),e("td",Y,o(m(s.points)),1),e("td",null,o(m(s.sxf)),1),e("td",{class:E(["status",s.state===1?"done":""])},o(s.state_label||"-"),3),e("td",Z,o(S(s.addtime)),1)]))),128)),c.value.length===0?(a(),n("tr",$,[...t[6]||(t[6]=[e("td",{colspan:"7",class:"empty-cell"},"暂无兑奖记录",-1)])])):D("",!0)])])]))])):(a(),n("div",j,[t[5]||(t[5]=e("div",{class:"verify-notice"},[e("span",{class:"notice-icon"},"!"),B(" 你需要通过密保验证后才能查看这个页面! ")],-1)),e("div",I,[e("div",A,[t[2]||(t[2]=e("label",{class:"form-label"},"安全问题",-1)),y(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),class:"form-select"},[(a(),n(_,null,b(g,s=>e("option",{key:s.value,value:s.value},o(s.label),9,G)),64))],512),[[L,d.value]])]),e("div",H,[t[3]||(t[3]=e("label",{class:"form-label"},"答案",-1)),y(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>i.value=s),class:"form-input",placeholder:"请输入答案"},null,512),[[U,i.value]])]),e("div",J,[t[4]||(t[4]=e("label",{class:"form-label"},null,-1)),e("button",{class:"btn-submit",onClick:k,disabled:u.value},o(u.value?"验证中...":"提交"),9,K)])])]))])]),_:1}))}}),oe=P(q,[["__scopeId","data-v-66caf672"]]);export{oe as default};
