import{d as ee,u as te,L as ae,j as m,C as se,o as oe,q as ne,w as k,e as t,c as g,r as T,F as E,h as b,t as l,g as o,x as re,s as F,y as I,D as U,n as V,b as w,f as L,B as le,m as f}from"./index-BrVULTij.js";import{u as ie,_ as N}from"./MainLayout-CqP2lYmd.js";import{U as ue}from"./UserLayout-CzbGZN-3.js";import{o as ce,u as de,a as R,E as A,n as B,t as pe}from"./vee-validate-zod-C7y-IhDo.js";import{a as me,b as fe,c as xe,d as ge}from"./agent-CyvHOYh8.js";import"./index-CELwjfbr.js";import{u as be,D as ve}from"./DataTable-D49Hiyp7.js";import{d as he}from"./dayjs.min-BAJkae7J.js";const ye={class:"flex flex-col gap-5"},_e={class:"flex gap-5 border-b border-[#eee] pb-[15px]"},ke=["onClick"],we={key:0},Ce={class:"flex gap-[30px] py-[15px]"},De={class:"flex items-center gap-2.5"},Se={class:"text-base font-bold text-[#ff6600]"},$e={class:"text-xs"},Me={class:"flex items-center gap-2.5"},Te={class:"text-base font-bold text-[#ff6600]"},Ee={class:"flex gap-[1px] flex-col"},Fe={class:"text-[15px] font-medium text-[#333333]",for:"uid"},Ie={class:"text-red-600"},Ue={class:"relative flex items-center gap-1"},Ve={class:"flex gap-[1px] flex-col"},Le={class:"text-[15px] font-medium text-[#333333] flex",for:"amount"},Ne=["data-val"],Re={class:"relative flex items-center"},Ae=["disabled"],Be={key:1,class:"min-h-[calc(100vh-120px)] pb-10"},Pe={class:"max-w-[1400px] mx-auto items-start max-[1200px]:grid-cols-1 max-[1200px]:max-w-[600px]"},Ye={class:"text-gray-400 text-xs"},je={class:"text-orange-600 font-bold"},Ze=ee({__name:"recharge",setup(ze){const P=[100,500,1e3,5e3],i=le(),Y=ie(),{locale:j}=te(),C=ae[j.value]??"USD",D=m(!1),c=m(),S=async()=>{D.value=!0;const{code:a,data:e}=await fe();a===200&&(c.value=e),D.value=!1},z=m(1),H=ce({uid:B({message:"请输入用户ID"}),amount:B({message:"请输入充值金额"})}).superRefine((a,e)=>{var u;const n=((u=c.value)==null?void 0:u.bankpoints)||0,r=a.amount*1e3;n!==void 0&&r>n&&e.addIssue({path:["amount"],message:"余额不足，无法充值",code:"custom"})}),q=pe(H),{handleSubmit:K,isSubmitting:v,resetForm:$,setFieldValue:O,setFieldError:Q}=de({validationSchema:q}),{value:d}=R("uid"),{value:_}=R("amount"),M=K(async a=>{var n;if((((n=c.value)==null?void 0:n.bankpoints)||0)<1){i.info("余额不足，无法充值");return}v.value=!0;try{const{code:r,message:u,data:s}=await me({amount:a.amount,uid:a.uid});r!==200?i.error(u):(i.success("充值成功"),Y.setCurrentCustomer({bankpoints:s.bankpoints}),$(),h.value=void 0,S())}catch(r){i.error(r.message||"提交失败")}finally{v.value=!1}}),h=m(),x=m(!1),G=async()=>{if(!x.value){if(!/^\d+$/.test(String(d.value))){Q("uid","请输入用户ID");return}x.value=!0;try{const{code:a,data:e,message:n}=await xe(d.value);a!==200?i.error(n):(h.value=`ID: ${e.aid}, 昵称: ${e.nickname||"-"}, 收款人: ${e.realname||"-"}`,i.success("检测成功"))}catch(a){const e=a instanceof Error?a.message:"检测失败，刷新页面请重试";i.error(e)}finally{x.value=!1}}},J=a=>{const n=a.target.closest("span[data-val]");if(!n)return;const r=n.dataset.val;r&&O("amount",Number(r),!0)},p=be(ge,{defaultSize:10,initQuery:{type:3}}),W=[{key:"addtime",title:"变动时间",width:"15%",align:"center"},{key:"points",title:"金豆",width:"15%",align:"center"},{key:"content",title:"操作内容",width:"20%",align:"center"}],y=m("recharge"),X=[{key:"recharge",name:"代理充值"},{key:"record",name:"充值记录"}],Z=a=>{y.value=a,a==="record"&&p.loadData(!0),a==="recharge"&&$()};return se(d,()=>{h.value=void 0}),oe(()=>{S()}),(a,e)=>(f(),ne(ue,null,{default:k(()=>{var n,r,u;return[t("div",ye,[t("div",_e,[(f(),g(E,null,T(X,s=>t("span",{key:s.key,class:V(["w-20 text-center text-sm cursor-pointer pb-3 border-b-2 border-transparent -mb-4 ",{"text-[#ff6600] border-b-[#ff6600]":y.value===s.key}]),onClick:He=>Z(s.key)},l(s.name),11,ke)),64))]),y.value==="recharge"?(f(),g("div",we,[t("div",Ce,[t("div",De,[e[4]||(e[4]=t("span",{class:"text-[15px] font-medium text-[#333333]"},"银行余额:",-1)),t("span",Se,[b(l(a.$n(((n=c.value)==null?void 0:n.bankpoints)||0))+" ",1),e[3]||(e[3]=t("img",{alt:"coin",class:"inline-block w-[13px] h-[13px]",src:N},null,-1))]),t("div",$e,"("+l(a.$n((((r=c.value)==null?void 0:r.bankpoints)||0)/1e3,{style:"currency",currency:o(C)}))+")",1)]),t("div",Me,[e[5]||(e[5]=t("span",{class:"text-[15px] font-medium text-[#333333]"},"折扣:",-1)),t("span",Te,l(a.$n((((u=c.value)==null?void 0:u.buycard_rate)||0)*10)),1),e[6]||(e[6]=b(" 折 ",-1))])]),(f(),g("form",{onSubmit:e[2]||(e[2]=re((...s)=>o(M)&&o(M)(...s),["prevent"])),class:"flex flex-col gap-6",key:z.value},[t("div",Ee,[t("label",Fe,[e[7]||(e[7]=b(" 用户ID ",-1)),t("span",Ie,l(h.value),1)]),t("div",Ue,[F(t("input",{id:"uid",type:"text",inputmode:"numeric",autocomplete:"one-time-code",placeholder:"请输入用户ID","onUpdate:modelValue":e[0]||(e[0]=s=>U(d)?d.value=s:null),class:"px-4 py-[14px] border-2 border-gray-200 rounded-lg text-[15px] transition-all duration-300 outline-none focus:border-[#667eea] focus:shadow-[0_0_0_3px_rgba(102,126,234,0.1)] flex-1 min-w-0 text-gray-600 placeholder-gray-400 focus:outline-none"},null,512),[[I,o(d),void 0,{number:!0}]]),t("button",{type:"button",onClick:G,class:V(["shrink-0 h-8 px-3 rounded text-xs whitespace-nowrap transition",x.value?"bg-gray-600 text-white cursor-not-allowed":"bg-blue-600 text-white active:scale-95 cursor-pointer"])},l(x.value?"检测中...":"检测账号"),3)]),w(o(A),{name:"uid",class:"text-[#ff4d4f] text-sm"})]),t("div",Ve,[t("label",Le,[e[8]||(e[8]=t("span",null,"充值金额",-1)),t("div",{class:"flex flex-wrap gap-2 justify-start w-5/7 ml-2",onClick:J},[(f(),g(E,null,T(P,s=>t("span",{key:`span-key-${s}`,"data-val":s,class:"shrink-0 h-8 px-3 py-1 rounded whitespace-nowrap transition bg-blue-600 text-white active:scale-95 cursor-pointer"},l(a.$n(s)),9,Ne)),64))])]),t("div",Re,[F(t("input",{type:"number",id:"amount",inputmode:"numeric",pattern:"[0-9]*",step:"100",min:"0","onUpdate:modelValue":e[1]||(e[1]=s=>U(_)?_.value=s:null),placeholder:"请输入充值金额",class:"px-4 py-[14px] pr-20 border-2 border-gray-200 rounded-lg text-[15px] transition-all duration-300 outline-none focus:border-[#667eea] focus:shadow-[0_0_0_3px_rgba(102,126,234,0.1)] flex-1 min-w-0 text-gray-600 placeholder-gray-400 focus:outline-none",autocomplete:"off",spellcheck:"false"},null,512),[[I,o(_),void 0,{number:!0}]]),e[9]||(e[9]=t("span",{class:"absolute right-4 text-[#666] text-[15px]"},"元",-1))]),w(o(A),{name:"amount",class:"text-[#ff4d4f] text-sm"})]),t("button",{type:"submit",disabled:o(v),class:"mt-4 p-4 bg-gradient-to-br from-[#ff6b6b] to-[#ee5a6f] text-white rounded-xl text-[18px] font-bold cursor-pointer transition-all duration-300 shadow-[0_4px_12px_rgba(255,107,107,0.3)] hover:-translate-y-[2px] hover:shadow-[0_6px_16px_rgba(255,107,107,0.4)] active:translate-y-0 disabled:opacity-60 disabled:cursor-not-allowed"},l(o(v)?"提交中...":"提交"),9,Ae)],32))])):L("",!0),y.value==="record"?(f(),g("div",Be,[t("div",Pe,[w(ve,{columns:W,data:o(p).dataSource.value,loading:o(p).loading.value,pagination:o(p).pagination.value,onChange:o(p).changePage,hasMore:o(p).hasMore.value},{"column-addtime":k(({row:s})=>[t("span",Ye,l(o(he).unix(s.addtime||0).format("YYYY-MM-DD HH:mm")),1)]),"column-points":k(({row:s})=>[t("div",je,[b(l(a.$n(s.points))+" ",1),e[10]||(e[10]=t("img",{alt:"coin",class:"inline-block w-[13px] h-[13px]",src:N},null,-1))]),b(" "+l(a.$n(((s==null?void 0:s.points)||0)/1e3,{style:"currency",currency:o(C)})),1)]),_:1},8,["data","loading","pagination","onChange","hasMore"])])])):L("",!0)])]}),_:1}))}});export{Ze as default};
