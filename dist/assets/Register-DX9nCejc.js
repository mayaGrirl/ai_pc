import{d as I,o as q,a as z,p as N,w as _,e as t,B as n,b as l,q as m,x as y,t as k,c as x,F as P,r as F,n as C,f as $,g as S,k as D,i as w,G as E,h as b,j as K,z as G,A as H,l as c}from"./index-BG9QW0k-.js";import{f as Z,u as J,S as O,M as Q,s as W,p as X}from"./MainLayout-Cy8swJD0.js";import{h as Y}from"./common-jqfb3mzs.js";import{S as ee,L as M,a as V}from"./sodium-U3nOFz3g.js";import{A as te,a as se,M as oe}from"./message-square-ChuLtIfh.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=Z("UserPlusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ae={class:"min-h-[calc(100vh-160px)] bg-gray-50/50 flex items-center justify-center p-6 relative overflow-hidden"},ne={class:"w-full max-w-[520px] bg-white rounded-[40px] shadow-2xl shadow-gray-200/50 border border-white/50 p-5 relative z-10 animate-in fade-in zoom-in duration-500"},le={class:"text-center mb-4"},ie={class:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-red-50 to-orange-50 rounded-[32px] mb-3 shadow-sm"},de={class:"space-y-5"},ce={class:"space-y-2"},ue={class:"relative group"},pe={class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"},fe={class:"space-y-2"},ge={class:"flex gap-3"},me={class:"relative flex-1 group"},ye={class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"},xe=["disabled"],be={class:"space-y-2"},we={class:"relative group"},ve={class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"},he={key:0,class:"px-1 pt-1 flex items-center justify-between"},_e={class:"flex gap-1 flex-1 max-w-[160px]"},ke={class:"space-y-2"},Ce={class:"relative group"},Se={class:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"},Me=["disabled"],Ve={key:0,class:"w-6 h-6 border-3 border-white/30 border-t-white rounded-full animate-spin"},je={key:1,class:"flex items-center gap-2 text-lg"},Ue={class:"text-center"},Ae={class:"mt-5 border-t border-gray-50 flex items-center justify-center gap-2 text-sm text-gray-400 italic"},ze=I({__name:"Register",setup(Le){const v=D(),j=G(),h=J(),r=H(),u=w(!1),d=w(0),p=w("");let f=null;const U=b(()=>j.query.t||""),s=E({mobile:"",verify_code:"",password:"",confirm_password:""});q(async()=>{try{const o=await Y();o.code===200&&o.data&&(p.value=o.data.key)}catch(o){console.error("Failed to get public key:",o)}}),z(()=>{f&&clearInterval(f)});const A=()=>{d.value=60,f=setInterval(()=>{d.value--,d.value<=0&&clearInterval(f)},1e3)},g=b(()=>{const o=s.password;if(!o)return 0;let e=0;return o.length>=6&&e++,o.length>=8&&e++,/[A-Z]/.test(o)&&e++,/[0-9]/.test(o)&&e++,Math.min(e,4)}),L=b(()=>["太简单","弱","中","强","极强"][g.value]),R=b(()=>["bg-gray-100","bg-red-400","bg-orange-400","bg-yellow-400","bg-green-500"][g.value]),T=async()=>{if(!s.mobile||!/^1[3-9]\d{9}$/.test(s.mobile)){r.error("请输入正确的11位手机号");return}try{const o=await W(s.mobile);o.code===200?(r.success("验证码已发送"),A()):r.error(o.message||"获取验证码失败")}catch(o){r.error(o.message||"获取验证码失败")}},B=async()=>{if(!s.mobile||s.mobile.length!==11){r.error("请输入正确的手机号");return}if(!s.verify_code){r.error("请输入短信验证码");return}if(!s.password||s.password.length<6){r.error("密码长度至少为6位");return}if(s.password!==s.confirm_password){r.error("两次输入的密码不一致");return}u.value=!0;try{let o=s.password,e=s.confirm_password;p.value&&(o=await V.encrypt(s.password,p.value),e=await V.encrypt(s.confirm_password,p.value));const i=await X({mobile:s.mobile,verify_code:s.verify_code,password:o,confirm_password:e,recommend:U.value||void 0});i.code===200&&i.data?(h.setToken(i.data.access_token,i.data.token_type,i.data.expires_at),await h.fetchCurrentCustomer(),r.success("注册成功"),await v.push("/")):r.error(i.message||"注册失败")}catch(o){r.error(o.message||"注册过程中发生错误")}finally{u.value=!1}};return(o,e)=>{const i=K("router-link");return c(),N(Q,null,{default:_(()=>[t("div",ae,[t("div",ne,[t("button",{onClick:e[0]||(e[0]=a=>n(v).push("/login")),class:"absolute top-8 left-8 p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-full transition-all group"},[l(n(te),{class:"w-5 h-5 group-hover:-translate-x-0.5 transition-transform"})]),t("div",le,[t("div",ie,[l(n(re),{class:"w-10 h-10 text-[#ff4757]"})]),e[5]||(e[5]=t("h1",{class:"text-3xl font-black text-gray-900 tracking-tight mb-3"},"创建新账号",-1)),e[6]||(e[6]=t("p",{class:"text-gray-500 font-medium"},"加入 鼎丰28，享受安全可信赖的游戏体验",-1))]),t("div",de,[t("div",ce,[e[7]||(e[7]=t("label",{class:"text-[12px] font-bold text-gray-400 uppercase tracking-wider ml-1"},"手机号码",-1)),t("div",ue,[t("div",pe,[l(n(O),{class:"w-5 h-5 text-gray-300 group-focus-within:text-[#ff4757] transition-colors"})]),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.mobile=a),type:"text",maxlength:"11",placeholder:"请输入您的11位手机号",class:"w-full pl-12 pr-4 py-4 bg-gray-50 border-transparent focus:bg-white focus:border-[#ff4757] focus:ring-4 focus:ring-red-50 rounded-2xl text-gray-700 font-medium transition-all outline-none border-2"},null,512),[[y,s.mobile]])])]),t("div",fe,[e[8]||(e[8]=t("label",{class:"text-[12px] font-bold text-gray-400 uppercase tracking-wider ml-1"},"短信验证码",-1)),t("div",ge,[t("div",me,[t("div",ye,[l(n(ee),{class:"w-5 h-5 text-gray-300 group-focus-within:text-[#ff4757] transition-colors"})]),m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.verify_code=a),type:"text",maxlength:"6",placeholder:"6位验证码",class:"w-full pl-12 pr-4 py-4 bg-gray-50 border-transparent focus:bg-white focus:border-[#ff4757] focus:ring-4 focus:ring-red-50 rounded-2xl text-gray-700 font-medium transition-all outline-none border-2"},null,512),[[y,s.verify_code]])]),t("button",{onClick:T,disabled:d.value>0,class:"px-6 py-4 bg-gray-100 text-gray-600 font-bold rounded-2xl hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap min-w-[120px]"},k(d.value>0?`${d.value}s`:"获取验证码"),9,xe)])]),t("div",be,[e[9]||(e[9]=t("label",{class:"text-[12px] font-bold text-gray-400 uppercase tracking-wider ml-1"},"设置登录密码",-1)),t("div",we,[t("div",ve,[l(n(M),{class:"w-5 h-5 text-gray-300 group-focus-within:text-[#ff4757] transition-colors"})]),m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>s.password=a),type:"password",placeholder:"密码不少于6位",class:"w-full pl-12 pr-4 py-4 bg-gray-50 border-transparent focus:bg-white focus:border-[#ff4757] focus:ring-4 focus:ring-red-50 rounded-2xl text-gray-700 font-medium transition-all outline-none border-2"},null,512),[[y,s.password]])]),s.password?(c(),x("div",he,[t("div",_e,[(c(),x(P,null,F(4,a=>t("div",{key:a,class:C(["h-1.5 flex-1 rounded-full transition-all duration-500",a<=g.value?R.value:"bg-gray-100"])},null,2)),64))]),t("span",{class:C(["text-[11px] font-bold",g.value>0?"text-gray-500":"text-gray-300"])}," 强度: "+k(L.value),3)])):$("",!0)]),t("div",ke,[e[10]||(e[10]=t("label",{class:"text-[12px] font-bold text-gray-400 uppercase tracking-wider ml-1"},"确认新密码",-1)),t("div",Ce,[t("div",Se,[l(n(M),{class:"w-5 h-5 text-gray-300 group-focus-within:text-[#ff4757] transition-colors"})]),m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>s.confirm_password=a),type:"password",placeholder:"请再次填写您的密码",class:"w-full pl-12 pr-4 py-4 bg-gray-50 border-transparent focus:bg-white focus:border-[#ff4757] focus:ring-4 focus:ring-red-50 rounded-2xl text-gray-700 font-medium transition-all outline-none border-2"},null,512),[[y,s.confirm_password]])])]),t("button",{onClick:B,disabled:u.value,class:"w-full py-3 mt-4 bg-gradient-to-r from-[#ff4757] to-[#ee5a6f] text-white font-black rounded-3xl shadow-xl shadow-red-100 hover:shadow-red-200 hover:-translate-y-1 active:translate-y-0 transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:hover:translate-y-0"},[u.value?(c(),x("span",Ve)):(c(),x("span",je,[e[11]||(e[11]=S("立即创建账户 ",-1)),l(n(se),{class:"w-5 h-5"})]))],8,Me),t("div",Ue,[e[13]||(e[13]=t("span",{class:"text-gray-400 font-medium"},"已有账户?",-1)),l(i,{to:"/login",class:"ml-2 text-[#ff4757] font-black hover:underline underline-offset-4"},{default:_(()=>[...e[12]||(e[12]=[S(" 直接登录 ",-1)])]),_:1})])]),t("div",Ae,[l(n(oe),{class:"w-4 h-4"}),e[14]||(e[14]=t("span",null,"遇到问题? 请联系您的代理提供支持",-1))])])])]),_:1})}}});export{ze as default};
