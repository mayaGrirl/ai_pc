import{d as S,o as C,y as N,w as V,f as e,c as n,r as i,k as z,j as p,A as B,F as y,g as b,v as L,t as a,e as U,p as o,n as D,s as E}from"./index-B3GHTeri.js";import{U as M}from"./UserLayout-BBBzWj5n.js";import{b as T}from"./shop-BVMZVUOB.js";import{f as F}from"./customer-sLMFGXI3.js";import"./MainLayout-CypWfAxo.js";const P={class:"exchange-page"},Q={key:0,class:"security-verify"},R={class:"verify-form"},j={class:"form-row"},A=["value"],I={class:"form-row"},G={class:"form-row"},H=["disabled"],J={key:1,class:"exchange-content"},K={key:0,class:"loading-state"},O={key:1,class:"exchange-table"},W={class:"coin"},X={class:"time"},Y={key:0},Z=S({__name:"Exchange",setup($){const f=i(!1),d=i("1"),r=i(""),u=i(!1),_=[{value:"1",label:"我父亲的姓名是什么?"},{value:"2",label:"我母亲的姓名是什么?"},{value:"3",label:"我的出生地是哪里?"},{value:"4",label:"我的小学名称是什么?"},{value:"5",label:"我最喜欢的颜色是什么?"}],c=i([]),v=i(!1),g=i(1),h=i(20),k=async()=>{if(!r.value.trim()){alert("请输入答案");return}u.value=!0;try{const l=await F({safe_ask:d.value,answer:r.value});l.code===200?(f.value=!0,x()):alert(l.message||"验证失败")}catch{alert("验证失败")}finally{u.value=!1}},x=async()=>{v.value=!0;try{const l=await T({pagination:{page:g.value,size:h.value}});l.code===200&&l.data&&(c.value=l.data)}catch(l){console.error("加载兑奖记录失败",l)}finally{v.value=!1}},w=l=>l?new Date(l*1e3).toLocaleString("zh-CN"):"-",m=l=>l===void 0?"0":l.toLocaleString();return C(()=>{}),(l,t)=>(o(),N(M,null,{default:V(()=>[e("div",P,[t[8]||(t[8]=e("div",{class:"page-tabs"},[e("span",{class:"tab active"},"兑奖记录")],-1)),f.value?(o(),n("div",J,[v.value?(o(),n("div",K,"加载中...")):(o(),n("div",O,[e("table",null,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",null,"卡号"),e("th",null,"卡密"),e("th",null,"类型"),e("th",null,"金豆"),e("th",null,"手续费"),e("th",null,"状态"),e("th",null,"兑换时间")])],-1)),e("tbody",null,[(o(!0),n(y,null,b(c.value,s=>(o(),n("tr",{key:s.id},[e("td",null,a(s.no||"-"),1),e("td",null,a(s.pwd||"-"),1),e("td",null,a(s.type_label||"-"),1),e("td",W,a(m(s.points)),1),e("td",null,a(m(s.sxf)),1),e("td",{class:D(["status",s.state===1?"done":""])},a(s.state_label||"-"),3),e("td",X,a(w(s.addtime)),1)]))),128)),c.value.length===0?(o(),n("tr",Y,[...t[6]||(t[6]=[e("td",{colspan:"7",class:"empty-cell"},"暂无兑奖记录",-1)])])):U("",!0)])])]))])):(o(),n("div",Q,[t[5]||(t[5]=e("div",{class:"verify-notice"},[e("span",{class:"notice-icon"},"!"),z(" 你需要通过密保验证后才能查看这个页面! ")],-1)),e("div",R,[e("div",j,[t[2]||(t[2]=e("label",{class:"form-label"},"安全问题",-1)),p(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),class:"form-select"},[(o(),n(y,null,b(_,s=>e("option",{key:s.value,value:s.value},a(s.label),9,A)),64))],512),[[B,d.value]])]),e("div",I,[t[3]||(t[3]=e("label",{class:"form-label"},"答案",-1)),p(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>r.value=s),class:"form-input",placeholder:"请输入答案"},null,512),[[L,r.value]])]),e("div",G,[t[4]||(t[4]=e("label",{class:"form-label"},null,-1)),e("button",{class:"btn-submit",onClick:k,disabled:u.value},a(u.value?"验证中...":"提交"),9,H)])])]))])]),_:1}))}}),ae=E(Z,[["__scopeId","data-v-66caf672"]]);export{ae as default};
