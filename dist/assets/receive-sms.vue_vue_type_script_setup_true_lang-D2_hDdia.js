import{d as h,u as y,C as _,a as g,c as n,F as b,e as i,n as x,t as w,i as r,l,A as k}from"./index-BxAaS0d6.js";import{a3 as V}from"./MainLayout-snc9tKFv.js";const B=["value"],C=["disabled"],S={key:0},T={key:1},I={key:2},A=60,R=h({__name:"receive-sms",props:{scene:{},modelValue:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(o,{emit:d}){const c=k(),m=o,p=d,{t:D}=y(),t=r(0),s=r(!1);let u=null;_(t,e=>{e<=0||(u=window.setTimeout(()=>{t.value--},1e3))}),g(()=>{u&&clearTimeout(u)});const v=async()=>{if(!(s.value||t.value>0)){s.value=!0;try{const{code:e,message:a}=await V(m.scene);e!==200?c.error(a):(c.success("发送成功"),t.value=A)}catch(e){const a=(e==null?void 0:e.message)||"发送失败，请稍后再试";c.error(a)}finally{s.value=!1}}},f=e=>{const a=e.target.value;p("update:modelValue",a)};return(e,a)=>(l(),n(b,null,[i("input",{id:"verify_code",value:o.modelValue,onInput:f,type:"text",inputmode:"numeric",pattern:"[0-9]*",autocomplete:"one-time-code",placeholder:"请输入验证码",class:"px-4 py-3 border-2 border-gray-200 rounded-lg text-sm transition-all duration-300 outline-none focus:border-[#667eea] focus:shadow-[0_0_0_3px_rgba(102,126,234,0.1)] flex-1 min-w-0 text-gray-600 placeholder-gray-400 focus:outline-none"},null,40,B),i("button",{type:"button",disabled:o.disabled||s.value||t.value>0,onClick:v,class:x(["shrink-0 h-8 px-3 rounded text-xs whitespace-nowrap transition",o.disabled||s.value||t.value>0?"bg-gray-600 text-white cursor-not-allowed":"bg-blue-600 text-white active:scale-95 cursor-pointer"])},[s.value?(l(),n("span",S,"发送中...")):t.value>0?(l(),n("span",T,w(t.value)+"s ",1)):(l(),n("span",I,"发送验证码"))],10,C)],64))}});export{R as _};
