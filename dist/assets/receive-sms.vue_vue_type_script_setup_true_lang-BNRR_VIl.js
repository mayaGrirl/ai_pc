import{d as h,u as y,D as _,a as g,c as n,F as b,e as r,n as x,t as w,k as i,p as l,B as k}from"./index-5CuYqb8n.js";import{Z as B}from"./MainLayout-DqBK_RG1.js";const V=["value"],S=["disabled"],T={key:0},C={key:1},D={key:2},I=60,U=h({__name:"receive-sms",props:{scene:{},modelValue:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(o,{emit:d}){const c=k(),m=o,p=d,{t:F}=y(),t=i(0),s=i(!1);let u=null;_(t,e=>{e<=0||(u=window.setTimeout(()=>{t.value--},1e3))}),g(()=>{u&&clearTimeout(u)});const v=async()=>{if(!(s.value||t.value>0)){s.value=!0;try{const{code:e,message:a}=await B(m.scene);e!==200?c.error(a):(c.success("发送成功"),t.value=I)}catch(e){const a=(e==null?void 0:e.message)||"发送失败，请稍后再试";c.error(a)}finally{s.value=!1}}},f=e=>{const a=e.target.value;p("update:modelValue",a)};return(e,a)=>(l(),n(b,null,[r("input",{id:"verify_code",value:o.modelValue,onInput:f,type:"text",inputmode:"numeric",pattern:"[0-9]*",autocomplete:"one-time-code",placeholder:"请输入验证码",class:"px-4 py-3 border-2 border-gray-200 rounded-lg text-sm transition-all duration-300 outline-none focus:border-[#667eea] focus:shadow-[0_0_0_3px_rgba(102,126,234,0.1)] flex-1 min-w-0 text-gray-600 placeholder-gray-400 focus:outline-none"},null,40,V),r("button",{type:"button",disabled:o.disabled||s.value||t.value>0,onClick:v,class:x(["shrink-0 h-8 px-3 rounded text-xs whitespace-nowrap transition",o.disabled||s.value||t.value>0?"bg-gray-600 text-white cursor-not-allowed":"bg-blue-600 text-white active:scale-95 cursor-pointer"])},[s.value?(l(),n("span",T,"发送中...")):t.value>0?(l(),n("span",C,w(t.value)+"s ",1)):(l(),n("span",D,"发送验证码"))],10,S)],64))}});export{U as _};
