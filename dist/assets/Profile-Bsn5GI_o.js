import{d as R,o as J,x as O,w as W,e,t as i,C as n,c as a,h as f,v as g,E as p,i as I,g as X,B as Y,k as b,p as r,s as Z}from"./index-D14D9v6l.js";import{U as ee}from"./UserLayout-svFC9TDn.js";import{u as te}from"./MainLayout-BLBr75Xh.js";import{B as se,C as le,D as oe}from"./customer-Cl1Slv0Y.js";import{o as re,s as x,u as ae,a as m,t as ne}from"./vee-validate-zod-CzOpuevj.js";function de(y,d=2,v=2,c="**"){return y.length<=d+v?y:`${y.slice(0,d)}${c}${y.slice(-v)}`}const ie={class:"flex flex-col gap-5"},ue={class:"flex gap-6 items-start"},fe={class:"flex-1 bg-white rounded-xl border border-gray-100 p-6 shadow-sm"},ge={class:"grid grid-cols-2 gap-4 mb-6 bg-gray-50 p-4 rounded-lg"},ce={class:"flex flex-col gap-1"},pe={class:"text-sm font-bold text-gray-800 font-mono"},xe={class:"flex flex-col gap-1"},me={class:"text-sm font-bold text-gray-800"},ye={class:"grid grid-cols-1 gap-5"},be={class:"flex flex-col gap-2"},ve={class:"relative"},he={key:1,class:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed select-none"},we={class:"flex flex-col gap-2"},ke={class:"relative"},_e={key:1,class:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed select-none"},qe={class:"flex flex-col gap-2"},Ce={class:"relative"},Se={key:1,class:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed select-none"},Ue={class:"flex flex-col gap-2"},Ve={class:"relative"},Be={key:1,class:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed select-none"},Ne={class:"flex flex-col gap-2"},Me={class:"relative"},Qe=["title"],De={class:"flex flex-col gap-2"},Ee=["disabled"],$e={class:"w-[320px] shrink-0"},je={class:"bg-white rounded-xl border border-gray-100 p-6 shadow-sm sticky top-5"},Fe={class:"flex flex-col items-center text-center"},Te={class:"text-lg font-bold text-gray-800 mb-1"},Ie={class:"text-xs text-gray-400 mb-6 font-mono"},Pe={class:"w-full bg-gray-50 rounded-lg p-4 border border-gray-100"},ze={key:0,class:"flex flex-col gap-3"},Le={key:1,class:"flex flex-col gap-3"},Ae={class:"flex gap-2"},Ge=R({__name:"Profile",setup(y){const d=Y(),v=te(),c=b(!1),u=b(""),P=()=>{var s;u.value=((s=l.value)==null?void 0:s.nickname)||"",c.value=!0},z=async()=>{if(!u.value){d.error("昵称不能为空");return}try{const{code:s,message:t}=await oe({nickname:u.value});s===200?(l.value&&(l.value.nickname=u.value),c.value=!1,d.success("昵称修改成功"),v.setCurrentCustomer({nickname:u.value})):d.error(t||"修改失败")}catch(s){d.error(s.message||"修改失败")}},L=b(1),A=re({realname:x().trim().refine(s=>s===""||s.length<=50,{message:"真实姓名不能超过50字符"}),qq:x().trim().refine(s=>s===""||/^\d{5,12}$/.test(s),{message:"QQ号格式不正确"}),alipay:x().trim().refine(s=>s===""||s.length<=50,{message:"支付宝账号不能超过50字符"}),wchat:x().trim().refine(s=>s===""||s.length<=50,{message:"微信账号不能超过50字符"}),address:x().trim().refine(s=>s===""||s.length<=150,{message:"地址不能超过150字符"}),signature:x().trim().refine(s=>s===""||s.length<=200,{message:"签名不能超过200字符"})}),G=ne(A),{handleSubmit:H,isSubmitting:h,resetForm:K}=ae({validationSchema:G}),{value:w}=m("realname"),{value:k}=m("qq"),{value:_}=m("alipay"),{value:q}=m("wchat"),{value:C}=m("address"),{value:S}=m("signature"),B=H(async s=>{h.value=!0;try{const{code:t,message:U,data:V}=await se({qq:s.qq,wchat:s.wchat,alipay:s.alipay,realname:s.realname,address:s.address,signature:s.signature});t!==200?d.error(U):(d.success("充值成功"),K(),M())}catch(t){d.error(t.message||"提交失败")}finally{h.value=!1}}),N=b(!1),l=b(),M=async()=>{N.value=!0;try{const{data:s,code:t}=await le();t===200&&(l.value=s,w.value=s.realname||"",k.value=s.qq||"",_.value=s.alipay||"",q.value=s.wchat||"",C.value=s.address||"",S.value=s.signature||"")}catch(s){console.error("Get member field error:",s)}finally{N.value=!1}};return J(()=>{M()}),(s,t)=>(r(),O(ee,null,{default:W(()=>{var U,V,Q,D,E,$,j,F,T;return[e("div",ie,[t[22]||(t[22]=e("div",{class:"flex gap-5 border-b border-[#eee] pb-[15px]"},[e("span",{class:"text-sm cursor-pointer pb-3 border-b-2 border-transparent -mb-4 text-[#ff6600] border-b-[#ff6600]"},"修改资料")],-1)),e("div",ue,[e("div",fe,[t[19]||(t[19]=e("div",{class:"mb-6 pb-4 border-b border-gray-100"},[e("h3",{class:"text-lg font-bold text-gray-800"},"基本资料"),e("p",{class:"text-sm text-gray-500 mt-1"},"完善您的个人信息，以便更好地为您服务")],-1)),e("div",ge,[e("div",ce,[t[9]||(t[9]=e("span",{class:"text-xs text-gray-500"},"手机号码",-1)),e("span",pe,i(n(de)(((U=l.value)==null?void 0:U.mobile)||"",3,4)),1)]),e("div",xe,[t[10]||(t[10]=e("span",{class:"text-xs text-gray-500"},"邮箱地址",-1)),e("span",me,i(((V=l.value)==null?void 0:V.email)||"未绑定"),1)])]),(r(),a("form",{onSubmit:t[6]||(t[6]=X((...o)=>n(B)&&n(B)(...o),["prevent"])),class:"flex flex-col gap-5",key:L.value},[e("div",ye,[e("div",be,[t[11]||(t[11]=e("label",{class:"text-sm font-medium text-gray-700",for:"qq"},"QQ号码",-1)),e("div",ve,[(Q=l.value)!=null&&Q.qq?(r(),a("div",he,i(l.value.qq),1)):f((r(),a("input",{key:0,id:"qq",type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>p(k)?k.value=o:null),placeholder:"请输入QQ号码",class:"w-full pl-3 pr-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#ff6600]/20 focus:border-[#ff6600] outline-none transition-all placeholder-gray-400"},null,512)),[[g,n(k)]])])]),e("div",we,[t[12]||(t[12]=e("label",{class:"text-sm font-medium text-gray-700",for:"wechat"},"微信号",-1)),e("div",ke,[(D=l.value)!=null&&D.wchat?(r(),a("div",_e,i(l.value.wchat),1)):f((r(),a("input",{key:0,id:"wechat",type:"text","onUpdate:modelValue":t[1]||(t[1]=o=>p(q)?q.value=o:null),placeholder:"请输入微信号码",class:"w-full pl-3 pr-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#ff6600]/20 focus:border-[#ff6600] outline-none transition-all placeholder-gray-400"},null,512)),[[g,n(q)]])])]),e("div",qe,[t[13]||(t[13]=e("label",{class:"text-sm font-medium text-gray-700",for:"alipay"},"支付宝账号",-1)),e("div",Ce,[(E=l.value)!=null&&E.alipay?(r(),a("div",Se,i(l.value.alipay),1)):f((r(),a("input",{key:0,id:"alipay",type:"text","onUpdate:modelValue":t[2]||(t[2]=o=>p(_)?_.value=o:null),placeholder:"请输入支付宝账号",class:"w-full pl-3 pr-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#ff6600]/20 focus:border-[#ff6600] outline-none transition-all placeholder-gray-400"},null,512)),[[g,n(_)]])])]),e("div",Ue,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-gray-700",for:"realName"},"真实姓名",-1)),e("div",Ve,[($=l.value)!=null&&$.realname?(r(),a("div",Be,[I(i(l.value.realname)+" ",1),t[14]||(t[14]=e("span",{class:"ml-2 text-xs text-green-600 bg-green-50 px-2 py-0.5 rounded-full border border-green-100"},"已实名",-1))])):f((r(),a("input",{key:0,id:"realName",type:"text","onUpdate:modelValue":t[3]||(t[3]=o=>p(w)?w.value=o:null),placeholder:"请输入真实姓名",class:"w-full pl-3 pr-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#ff6600]/20 focus:border-[#ff6600] outline-none transition-all placeholder-gray-400"},null,512)),[[g,n(w)]])])]),e("div",Ne,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-gray-700",for:"address"},"收货地址",-1)),e("div",Me,[(j=l.value)!=null&&j.address?(r(),a("div",{key:1,class:"w-full px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600 cursor-not-allowed select-none truncate",title:l.value.address},i(l.value.address),9,Qe)):f((r(),a("input",{key:0,id:"address",type:"text","onUpdate:modelValue":t[4]||(t[4]=o=>p(C)?C.value=o:null),placeholder:"请填写真实收货地址",class:"w-full pl-3 pr-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-[#ff6600]/20 focus:border-[#ff6600] outline-none transition-all placeholder-gray-400"},null,512)),[[g,n(C)]])])]),e("div",De,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-gray-700",for:"signature"},"个人签名",-1)),f(e("textarea",{id:"signature","onUpdate:modelValue":t[5]||(t[5]=o=>p(S)?S.value=o:null),rows:"3",placeholder:"写一句话介绍自己...",class:"w-full p-3 border border-gray-300 rounded-lg text-sm leading-relaxed focus:ring-2 focus:ring-[#ff6600]/20 focus:border-[#ff6600] outline-none transition-all placeholder-gray-400 resize-none"},null,512),[[g,n(S)]])])]),t[18]||(t[18]=e("div",{class:"flex items-start gap-2 bg-orange-50 p-3 rounded-lg border border-orange-100"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#ff6600","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]),e("span",{class:"text-xs text-orange-700 leading-tight"},"温馨提示：部分资料保存后不可再次修改，请务必填写真实有效的信息。如有填写错误，请联系在线客服处理。")],-1)),e("button",{type:"submit",disabled:n(h),class:"w-full py-3 bg-gradient-to-r from-[#ff6600] to-[#ff8533] text-white rounded-lg text-sm font-bold shadow-lg shadow-orange-500/30 hover:shadow-orange-500/40 hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-200"},i(n(h)?"保存中...":"保存资料"),9,Ee)],32))]),e("div",$e,[e("div",je,[e("div",Fe,[e("h3",Te,i(((F=l.value)==null?void 0:F.nickname)||"未设置昵称"),1),e("p",Ie,"ID: "+i(((T=l.value)==null?void 0:T.aid)||"-"),1),e("div",Pe,[t[21]||(t[21]=e("div",{class:"text-xs font-bold text-gray-500 mb-3 text-left uppercase tracking-wider"},"修改昵称",-1)),c.value?(r(),a("div",Le,[f(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>u.value=o),type:"text",placeholder:"请输入新昵称",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm outline-none focus:border-[#ff6600]",maxlength:"12"},null,512),[[g,u.value]]),e("div",Ae,[e("button",{onClick:t[8]||(t[8]=o=>c.value=!1),class:"flex-1 py-1.5 bg-gray-200 text-gray-600 rounded text-xs hover:bg-gray-300 transition-colors"}," 取消 "),e("button",{onClick:z,class:"flex-1 py-1.5 bg-[#ff6600] text-white rounded text-xs hover:bg-[#ff5500] transition-colors"}," 确认 ")])])):(r(),a("div",ze,[e("button",{onClick:P,class:"w-full py-2 bg-white border border-gray-200 text-gray-700 rounded-md text-sm hover:border-[#ff6600] hover:text-[#ff6600] transition-colors flex items-center justify-center gap-2"},[...t[20]||(t[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1),I(" 点击修改 ",-1)])])]))])])])])])])]}),_:1}))}}),We=Z(Ge,[["__scopeId","data-v-09216d25"]]);export{We as default};
